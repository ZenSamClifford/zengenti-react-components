{
  "version": 3,
  "file": "client.js",
  "sources": [
    "../src/client/client.tsx"
  ],
  "sourcesContent": [
    "import 'isomorphic-fetch';\r\nimport React from 'react';\r\nimport { render, hydrate } from 'react-dom';\r\nimport { Router } from 'react-router-dom';\r\nimport { preloadReady } from 'react-loadable';\r\nimport { AppContainer } from 'react-hot-loader';\r\nimport { Provider as ReduxProvider } from 'react-redux';\r\nimport * as queryString from 'query-string';\r\n// import { fromJS } from 'immutable';\r\n\r\nimport createStore from '~/redux/store/store';\r\nimport { browserHistory as history } from '~/redux/store/history';\r\nimport rootSaga from '~/redux/sagas';\r\n\r\nimport { setVersionStatus } from '~/redux/actions/version';\r\nimport { deliveryApi } from '~/util/ContensisDeliveryApi';\r\nimport { setCurrentProject } from '~/routing/redux/actions';\r\nimport pickProject from '~/util/pickProject';\r\n\r\nimport { AppConfig } from '~/config';\r\n\r\ndeclare let window: typeof globalThis & {\r\n  isDynamic;\r\n  REDUX_DATA;\r\n};\r\n\r\ntype ReactAppProps = { routes: any; withEvents: any };\r\n\r\nclass ClientApp {\r\n  constructor(ReactApp: React.ComponentType<ReactAppProps>, config: AppConfig) {\r\n    const documentRoot = document.getElementById('root');\r\n\r\n    const {\r\n      stateType = 'immutable',\r\n      routes,\r\n      withReducers,\r\n      withSagas,\r\n      withEvents,\r\n    } = config;\r\n\r\n    const GetClientJSX = store => {\r\n      const ClientJsx = (\r\n        <AppContainer>\r\n          <ReduxProvider store={store}>\r\n            <Router history={history}>\r\n              <ReactApp routes={routes} withEvents={withEvents} />\r\n            </Router>\r\n          </ReduxProvider>\r\n        </AppContainer>\r\n      );\r\n      return ClientJsx;\r\n    };\r\n\r\n    const isProduction = !(process.env.NODE_ENV !== 'production');\r\n\r\n    /**\r\n     * Webpack HMR Setup.\r\n     */\r\n    const HMRRenderer = Component => {\r\n      preloadReady().then(() => {\r\n        if (isProduction) hydrate(Component, documentRoot);\r\n        else render(Component, documentRoot);\r\n      });\r\n    };\r\n\r\n    const hmr = store => {\r\n      // webpack Hot Module Replacement API\r\n      if (module.hot) {\r\n        module.hot.accept(ReactApp as unknown as string, () => {\r\n          // if you are using harmony modules ({modules:false})\r\n          HMRRenderer(GetClientJSX(store));\r\n        });\r\n      }\r\n    };\r\n\r\n    const qs = queryString.parse(window.location.search);\r\n    const versionStatusFromHostname = deliveryApi.getClientSideVersionStatus();\r\n\r\n    if (\r\n      window.isDynamic ||\r\n      window.REDUX_DATA ||\r\n      process.env.NODE_ENV !== 'production'\r\n    ) {\r\n      createStore(withReducers, window.REDUX_DATA, history, stateType).then(\r\n        store => {\r\n          store.dispatch(\r\n            setVersionStatus(qs.versionStatus || versionStatusFromHostname)\r\n          );\r\n\r\n          /* eslint-disable no-console */\r\n          console.log('Hydrating from inline Redux');\r\n          /* eslint-enable no-console */\r\n          store.runSaga(rootSaga(withSagas));\r\n          store.dispatch(\r\n            setCurrentProject(\r\n              pickProject(window.location.hostname, qs),\r\n              [],\r\n              window.location.hostname\r\n            )\r\n          );\r\n\r\n          delete window.REDUX_DATA;\r\n          HMRRenderer(GetClientJSX(store));\r\n\r\n          hmr(store);\r\n        }\r\n      );\r\n    } else {\r\n      fetch(`${window.location.pathname}?redux=true`)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          /* eslint-disable no-console */\r\n          // console.log('Got Data Back');\r\n          // console.log(data);\r\n          /* eslint-enable no-console */\r\n          const ssRedux = JSON.parse(data);\r\n          createStore(withReducers, ssRedux, history, stateType).then(store => {\r\n            // store.dispatch(setVersionStatus(versionStatusFromHostname));\r\n\r\n            store.runSaga(rootSaga(withSagas));\r\n            store.dispatch(\r\n              setCurrentProject(\r\n                pickProject(\r\n                  window.location.hostname,\r\n                  queryString.parse(window.location.search)\r\n                ),\r\n                [],\r\n                window.location.hostname\r\n              )\r\n            );\r\n            // if (typeof window != 'undefined') {\r\n            //   store.dispatch(checkUserLoggedIn());\r\n            // }\r\n            HMRRenderer(GetClientJSX(store));\r\n\r\n            hmr(store);\r\n          });\r\n        });\r\n    }\r\n  }\r\n}\r\n\r\nexport default ClientApp;\r\n"
  ],
  "names": [
    "ClientApp",
    "constructor",
    "ReactApp",
    "config",
    "documentRoot",
    "document",
    "getElementById",
    "stateType",
    "routes",
    "withReducers",
    "withSagas",
    "withEvents",
    "GetClientJSX",
    "store",
    "ClientJsx",
    "React",
    "AppContainer",
    "ReduxProvider",
    "Router",
    "history",
    "isProduction",
    "process",
    "env",
    "NODE_ENV",
    "HMRRenderer",
    "Component",
    "preloadReady",
    "then",
    "hydrate",
    "render",
    "hmr",
    "module",
    "hot",
    "accept",
    "qs",
    "queryString",
    "parse",
    "window",
    "location",
    "search",
    "versionStatusFromHostname",
    "deliveryApi",
    "getClientSideVersionStatus",
    "isDynamic",
    "REDUX_DATA",
    "createStore",
    "dispatch",
    "setVersionStatus",
    "versionStatus",
    "console",
    "log",
    "runSaga",
    "rootSaga",
    "setCurrentProject",
    "pickProject",
    "hostname",
    "fetch",
    "pathname",
    "response",
    "json",
    "data",
    "ssRedux",
    "JSON"
  ],
  "mappings": "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"
}
