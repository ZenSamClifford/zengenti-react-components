{"version":3,"file":"version-10dcc7ba.js","sources":["../src/redux/types/navigation.js","../src/redux/reducers/navigation.js","../src/routing/redux/reducers.js","../src/redux/types/version.js","../src/redux/reducers/version.js","../src/redux/store/routerMiddleware.js","../src/redux/store/store.ts","../src/redux/selectors/navigation.js","../src/redux/store/injectors.js","../src/redux/actions/version.js"],"sourcesContent":["const ACTION_PREFIX = '@NAVIGATION/';\r\nexport const GET_NODE_TREE = `${ACTION_PREFIX}_GET_NODE_TREE`;\r\nexport const SET_NODE_TREE = `${ACTION_PREFIX}_SET_NODE_TREE`;\r\nexport const GET_NODE_TREE_ERROR = `${ACTION_PREFIX}_GET_NODE_TREE_ERROR`;\r\n","import { Map, fromJS, List } from 'immutable';\r\n\r\nimport { SET_NODE_TREE, GET_NODE_TREE_ERROR } from '~/redux/types/navigation';\r\n\r\nconst initialState = Map({\r\n  root: null,\r\n  treeDepends: new List([]),\r\n  isError: false,\r\n  isReady: false,\r\n});\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case SET_NODE_TREE: {\r\n      return state.set('root', fromJS(action.nodes)).set('isReady', true);\r\n    }\r\n    case GET_NODE_TREE_ERROR: {\r\n      return state.set('isError', true);\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { OrderedMap, fromJS, List, Set } from 'immutable';\r\nimport {\r\n  SET_ENTRY,\r\n  SET_NAVIGATION_PATH,\r\n  SET_ANCESTORS,\r\n  SET_TARGET_PROJECT,\r\n  SET_ROUTE,\r\n  SET_SIBLINGS,\r\n  SET_SURROGATE_KEYS,\r\n  UPDATE_LOADING_STATE,\r\n} from './types';\r\n\r\nlet initialState = OrderedMap({\r\n  currentHostname: null,\r\n  contentTypeId: null,\r\n  currentPath: '/',\r\n  currentNode: OrderedMap(),\r\n  currentNodeAncestors: List(),\r\n  currentProject: 'unknown',\r\n  entryID: null,\r\n  entry: null,\r\n  currentTreeId: null,\r\n  entryDepends: List(),\r\n  error: undefined,\r\n  isError: false,\r\n  isLoading: false,\r\n  location: OrderedMap(),\r\n  mappedEntry: null,\r\n  nodeDepends: List(),\r\n  notFound: false,\r\n  staticRoute: null,\r\n  statusCode: 200,\r\n});\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case SET_ANCESTORS: {\r\n      if (action.ancestors) {\r\n        return state.set('currentNodeAncestors', fromJS(action.ancestors));\r\n      }\r\n      return state.set('currentNodeAncestors', fromJS(action.ancestors));\r\n    }\r\n    case SET_ENTRY: {\r\n      const {\r\n        entry,\r\n        error,\r\n        mappedEntry,\r\n        node = {},\r\n        isError = false,\r\n        isLoading = false,\r\n        notFound = false,\r\n        statusCode,\r\n      } = action;\r\n\r\n      let defaultStatus = 200;\r\n      if (notFound === true && isError === false) defaultStatus = 404;\r\n      else if (isError === true) defaultStatus = statusCode || 500;\r\n\r\n      let nextState;\r\n\r\n      if (!entry) {\r\n        nextState = state\r\n          .set('entryID', null)\r\n          .set('entry', null)\r\n          .set('error', fromJS(error))\r\n          .set('mappedEntry', null)\r\n          .set('isError', isError)\r\n          .set('isLoading', isLoading)\r\n          .set('notFound', notFound)\r\n          .set('statusCode', statusCode || defaultStatus);\r\n      } else {\r\n        nextState = state\r\n          .set('entryID', action.id)\r\n          .set('entry', fromJS(entry))\r\n          .set('error', fromJS(error))\r\n          .set('isError', isError)\r\n          .set('isLoading', isLoading)\r\n          .set('notFound', notFound)\r\n          .set('statusCode', statusCode || defaultStatus);\r\n\r\n        if (mappedEntry && Object.keys(mappedEntry).length > 0)\r\n          nextState = nextState\r\n            .set('mappedEntry', fromJS(mappedEntry))\r\n            .set('entry', fromJS({ sys: entry.sys }));\r\n      }\r\n\r\n      if (!node) {\r\n        return nextState.set('nodeDepends', null).set('currentNode', null);\r\n      } else {\r\n        // On Set Node, we reset all dependants.\r\n        return nextState\r\n          .set('currentNode', fromJS(node))\r\n          .removeIn(['currentNode', 'entry']); // We have the entry stored elsewhere, so lets not keep it twice.\r\n      }\r\n    }\r\n    case UPDATE_LOADING_STATE: {\r\n      return state.set('isLoading', action.isLoading);\r\n    }\r\n    case SET_NAVIGATION_PATH: {\r\n      let staticRoute = false;\r\n      if (action.staticRoute) {\r\n        staticRoute = { ...action.staticRoute };\r\n      }\r\n      if (action.path) {\r\n        // Don't run a path update on initial load as we allready should have it in redux\r\n        const entryUri = state.getIn(['entry', 'sys', 'uri']);\r\n        if (entryUri != action.path) {\r\n          return state\r\n            .set('currentPath', fromJS(action.path))\r\n            .set('location', fromJS(action.location))\r\n            .set(\r\n              'staticRoute',\r\n              fromJS({\r\n                ...staticRoute,\r\n                route: { ...staticRoute.route, component: null },\r\n              })\r\n            )\r\n            .set('isLoading', typeof window !== 'undefined');\r\n        } else {\r\n          return state.set('location', fromJS(action.location)).set(\r\n            'staticRoute',\r\n            fromJS({\r\n              ...staticRoute,\r\n              route: { ...staticRoute.route, component: null },\r\n            })\r\n          );\r\n        }\r\n      }\r\n      return state;\r\n    }\r\n    case SET_ROUTE: {\r\n      return state.set('nextPath', action.path);\r\n    }\r\n    case SET_SIBLINGS: {\r\n      // Can be null in some cases like the homepage.\r\n      let currentNodeSiblingParent = null;\r\n      let siblingIDs = [];\r\n      if (action.siblings && action.siblings.length > 0) {\r\n        currentNodeSiblingParent = action.siblings[0].parentId;\r\n        siblingIDs = action.siblings.map(node => {\r\n          return node.id;\r\n        });\r\n      }\r\n      let currentNodeDepends = state.get('nodeDepends');\r\n      const allNodeDepends = Set.union([Set(siblingIDs), currentNodeDepends]);\r\n      return state\r\n        .set('nodeDepends', allNodeDepends)\r\n        .set('currentNodeSiblings', fromJS(action.siblings))\r\n        .set('currentNodeSiblingsParent', currentNodeSiblingParent);\r\n    }\r\n    case SET_SURROGATE_KEYS: {\r\n      return state.set('surrogateKeys', action.keys);\r\n    }\r\n    case SET_TARGET_PROJECT: {\r\n      return state\r\n        .set('currentProject', action.project)\r\n        .set('currentTreeId', '') //getTreeID(action.project))\r\n        .set('allowedGroups', fromJS(action.allowedGroups))\r\n        .set('currentHostname', action.hostname);\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","const VERSION_PREFIX = '@VERSION/';\r\nexport const SET_VERSION = `${VERSION_PREFIX}SET_VERSION`;\r\nexport const SET_VERSION_STATUS = `${VERSION_PREFIX}SET_VERSION_STATUS`;\r\n","import { Map } from 'immutable';\r\nimport { SET_VERSION, SET_VERSION_STATUS } from '~/redux/types/version';\r\n\r\nlet initialState = Map({\r\n  commitRef: null,\r\n  buildNo: null,\r\n  contensisVersionStatus: 'published',\r\n});\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case SET_VERSION_STATUS: {\r\n      return state.set('contensisVersionStatus', action.status);\r\n    }\r\n    case SET_VERSION: {\r\n      return state\r\n        .set('commitRef', action.commitRef)\r\n        .set('buildNo', action.buildNo);\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","/**\r\n * This middleware captures 'CALL_HISTORY_METHOD' actions to redirect to the\r\n * provided history object. This will prevent these actions from reaching your\r\n * reducer or any middleware that comes after this one.\r\n */\r\n/* eslint-disable no-unused-vars */\r\nconst routerMiddleware = history => store => next => action => {\r\n  if (action.type !== 'CALL_HISTORY_METHOD') {\r\n    return next(action);\r\n  }\r\n\r\n  const {\r\n    payload: { method, args },\r\n  } = action;\r\n  history[method](...args);\r\n};\r\n\r\nexport default routerMiddleware;\r\n","/* eslint-disable no-underscore-dangle */\r\nimport {\r\n  Action,\r\n  applyMiddleware,\r\n  compose,\r\n  createStore,\r\n  Store,\r\n  StoreEnhancer,\r\n} from 'redux';\r\nimport { combineReducers } from 'redux-immutable';\r\nimport thunkMiddleware from 'redux-thunk';\r\nimport createSagaMiddleware, { END } from 'redux-saga';\r\nimport { createInjectorsEnhancer } from 'redux-injectors';\r\n\r\n// Core reducers\r\nimport NavigationReducer from '../reducers/navigation';\r\nimport RoutingReducer from '~/routing/redux/reducers';\r\nimport UserReducer from '~/user/redux/reducers';\r\nimport VersionReducer from '../reducers/version';\r\nimport routerMiddleware from './routerMiddleware';\r\n\r\nexport let reduxStore;\r\n\r\ndeclare let window: Window &\r\n  typeof globalThis & {\r\n    __REDUX_DEVTOOLS_EXTENSION__: any;\r\n  };\r\n\r\nexport default (featureReducers, initialState, history) => {\r\n  let reduxDevToolsMiddleware = f => f;\r\n\r\n  if (typeof window != 'undefined') {\r\n    reduxDevToolsMiddleware = window.__REDUX_DEVTOOLS_EXTENSION__\r\n      ? window.__REDUX_DEVTOOLS_EXTENSION__()\r\n      : f => f;\r\n  }\r\n\r\n  const sagaMiddleware = createSagaMiddleware();\r\n\r\n  const reducers = {\r\n    navigation: NavigationReducer,\r\n    routing: RoutingReducer,\r\n    user: UserReducer,\r\n    version: VersionReducer,\r\n    ...featureReducers,\r\n  };\r\n\r\n  const createReducer = (injectedReducers = {}) => {\r\n    const rootReducer = combineReducers({\r\n      ...injectedReducers,\r\n      // other non-injected reducers go here\r\n      ...reducers,\r\n    });\r\n\r\n    return rootReducer;\r\n  };\r\n\r\n  const store = initialState => {\r\n    const runSaga = sagaMiddleware.run;\r\n\r\n    const middleware: StoreEnhancer<\r\n      {\r\n        dispatch: unknown;\r\n      },\r\n      unknown\r\n    > = compose(\r\n      applyMiddleware(\r\n        thunkMiddleware,\r\n        sagaMiddleware,\r\n        routerMiddleware(history)\r\n      ),\r\n      createInjectorsEnhancer({\r\n        createReducer,\r\n        runSaga,\r\n      }),\r\n      reduxDevToolsMiddleware\r\n    );\r\n\r\n    const store: Store<any, Action<any>> & {\r\n      runSaga?: typeof runSaga;\r\n      close?: () => void;\r\n    } = createStore(createReducer(), initialState, middleware);\r\n\r\n    store.runSaga = runSaga;\r\n    store.close = () => store.dispatch(END);\r\n\r\n    return store;\r\n  };\r\n\r\n  reduxStore = store(initialState);\r\n  return reduxStore;\r\n};\r\n","export const hasNavigationTree = state => {\r\n  return state.getIn(['navigation', 'isReady']);\r\n};\r\n\r\nexport const selectNavigationRoot = state => {\r\n  return state.getIn(['navigation', 'root']);\r\n};\r\n\r\nexport const selectNavigationDepends = state => {\r\n  return state.getIn(['navigation', 'treeDepends']);\r\n};\r\n","import { all } from 'redux-saga/effects';\r\nimport { reduxStore as DefaultStore } from './store';\r\n\r\nexport const convertSagaArray = sagas => {\r\n  if (Array.isArray(sagas))\r\n    return function* rootSaga() {\r\n      yield all(sagas);\r\n    };\r\n  return sagas;\r\n};\r\n\r\nexport const injectReducer = ({ key, reducer }, store = DefaultStore) => {\r\n  if (\r\n    Reflect.has(store.injectedReducers, key) &&\r\n    store.injectedReducers[key] === reducer\r\n  )\r\n    return;\r\n  store.injectedReducers[key] = reducer;\r\n\r\n  store.replaceReducer(store.createReducer(store.injectedReducers));\r\n};\r\n\r\nexport const injectSaga = ({ key, saga }, store = DefaultStore) => {\r\n  const rootSaga = convertSagaArray(saga);\r\n  let hasSaga = Reflect.has(store.injectedSagas, key);\r\n\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    const oldDescriptor = store.injectedSagas[key]; // enable hot reloading of daemon and once-till-unmount sagas\r\n\r\n    if (hasSaga && oldDescriptor.saga !== rootSaga) {\r\n      oldDescriptor.task.cancel();\r\n      hasSaga = false;\r\n    }\r\n  }\r\n  console.info('injectSaga, key: ', key, 'hasSaga: ', hasSaga);\r\n\r\n  if (!hasSaga) {\r\n    store.injectedSagas[key] = {\r\n      key,\r\n      saga: rootSaga,\r\n      task: store.runSaga(rootSaga),\r\n    };\r\n  }\r\n};\r\n\r\nexport const injectRedux = ({ key, reducer, saga }, store = DefaultStore) => {\r\n  console.info('injectRedux, key: ', key);\r\n  if (reducer) injectReducer({ key, reducer }, store);\r\n  if (saga) injectSaga({ key, saga }, store);\r\n};\r\n\r\nexport const useInjectRedux = injectRedux;\r\n","import { action } from '../util';\r\nimport { SET_VERSION, SET_VERSION_STATUS } from '../types/version';\r\n\r\nexport const setVersion = (commitRef, buildNo) =>\r\n  action(SET_VERSION, { commitRef, buildNo });\r\n\r\nexport const setVersionStatus = status =>\r\n  action(SET_VERSION_STATUS, { status });\r\n"],"names":["ACTION_PREFIX","GET_NODE_TREE","SET_NODE_TREE","GET_NODE_TREE_ERROR","initialState","Map","root","treeDepends","List","isError","isReady","state","action","type","set","fromJS","nodes","OrderedMap","currentHostname","contentTypeId","currentPath","currentNode","currentNodeAncestors","currentProject","entryID","entry","currentTreeId","entryDepends","error","undefined","isLoading","location","mappedEntry","nodeDepends","notFound","staticRoute","statusCode","SET_ANCESTORS","ancestors","SET_ENTRY","node","defaultStatus","nextState","id","Object","keys","length","sys","removeIn","UPDATE_LOADING_STATE","SET_NAVIGATION_PATH","path","entryUri","getIn","route","component","window","SET_ROUTE","SET_SIBLINGS","currentNodeSiblingParent","siblingIDs","siblings","parentId","map","currentNodeDepends","get","allNodeDepends","Set","union","SET_SURROGATE_KEYS","SET_TARGET_PROJECT","project","allowedGroups","hostname","VERSION_PREFIX","SET_VERSION","SET_VERSION_STATUS","commitRef","buildNo","contensisVersionStatus","status","routerMiddleware","history","store","next","payload","method","args","reduxStore","featureReducers","reduxDevToolsMiddleware","f","__REDUX_DEVTOOLS_EXTENSION__","sagaMiddleware","createSagaMiddleware","reducers","navigation","NavigationReducer","routing","RoutingReducer","user","UserReducer","version","VersionReducer","createReducer","injectedReducers","rootReducer","combineReducers","runSaga","run","middleware","compose","applyMiddleware","thunkMiddleware","createInjectorsEnhancer","createStore","close","dispatch","END","hasNavigationTree","selectNavigationRoot","selectNavigationDepends","convertSagaArray","sagas","Array","isArray","rootSaga","all","injectReducer","key","reducer","DefaultStore","Reflect","has","replaceReducer","injectSaga","saga","hasSaga","injectedSagas","process","env","NODE_ENV","oldDescriptor","task","cancel","console","info","injectRedux","useInjectRedux","setVersion","setVersionStatus"],"mappings":";;;;;;;;;;;;;;;;;AAAA,MAAMA,aAAa,GAAG,cAAtB;MACaC,aAAa,GAAI,GAAED,aAAc;MACjCE,aAAa,GAAI,GAAEF,aAAc;MACjCG,mBAAmB,GAAI,GAAEH,aAAc;;;;;;;;;ACCpD,MAAMI,cAAY,GAAGC,aAAG,CAAC;AACvBC,EAAAA,IAAI,EAAE,IADiB;AAEvBC,EAAAA,WAAW,EAAE,IAAIC,cAAJ,CAAS,EAAT,CAFU;AAGvBC,EAAAA,OAAO,EAAE,KAHc;AAIvBC,EAAAA,OAAO,EAAE;AAJc,CAAD,CAAxB;AAOA,yBAAe,CAACC,KAAK,GAAGP,cAAT,EAAuBQ,MAAvB,KAAkC;AAC/C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKX,aAAL;AAAoB;AAClB,eAAOS,KAAK,CAACG,GAAN,CAAU,MAAV,EAAkBC,gBAAM,CAACH,MAAM,CAACI,KAAR,CAAxB,EAAwCF,GAAxC,CAA4C,SAA5C,EAAuD,IAAvD,CAAP;AACD;;AACD,SAAKX,mBAAL;AAA0B;AACxB,eAAOQ,KAAK,CAACG,GAAN,CAAU,SAAV,EAAqB,IAArB,CAAP;AACD;;AACD;AACE,aAAOH,KAAP;AARJ;AAUD,CAXD;;ACCA,IAAIP,cAAY,GAAGa,oBAAU,CAAC;AAC5BC,EAAAA,eAAe,EAAE,IADW;AAE5BC,EAAAA,aAAa,EAAE,IAFa;AAG5BC,EAAAA,WAAW,EAAE,GAHe;AAI5BC,EAAAA,WAAW,EAAEJ,oBAAU,EAJK;AAK5BK,EAAAA,oBAAoB,EAAEd,cAAI,EALE;AAM5Be,EAAAA,cAAc,EAAE,SANY;AAO5BC,EAAAA,OAAO,EAAE,IAPmB;AAQ5BC,EAAAA,KAAK,EAAE,IARqB;AAS5BC,EAAAA,aAAa,EAAE,IATa;AAU5BC,EAAAA,YAAY,EAAEnB,cAAI,EAVU;AAW5BoB,EAAAA,KAAK,EAAEC,SAXqB;AAY5BpB,EAAAA,OAAO,EAAE,KAZmB;AAa5BqB,EAAAA,SAAS,EAAE,KAbiB;AAc5BC,EAAAA,QAAQ,EAAEd,oBAAU,EAdQ;AAe5Be,EAAAA,WAAW,EAAE,IAfe;AAgB5BC,EAAAA,WAAW,EAAEzB,cAAI,EAhBW;AAiB5B0B,EAAAA,QAAQ,EAAE,KAjBkB;AAkB5BC,EAAAA,WAAW,EAAE,IAlBe;AAmB5BC,EAAAA,UAAU,EAAE;AAnBgB,CAAD,CAA7B;AAsBA,sBAAe,CAACzB,KAAK,GAAGP,cAAT,EAAuBQ,MAAvB,KAAkC;AAC/C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKwB,qBAAL;AAAoB;AAClB,YAAIzB,MAAM,CAAC0B,SAAX,EAAsB;AACpB,iBAAO3B,KAAK,CAACG,GAAN,CAAU,sBAAV,EAAkCC,gBAAM,CAACH,MAAM,CAAC0B,SAAR,CAAxC,CAAP;AACD;;AACD,eAAO3B,KAAK,CAACG,GAAN,CAAU,sBAAV,EAAkCC,gBAAM,CAACH,MAAM,CAAC0B,SAAR,CAAxC,CAAP;AACD;;AACD,SAAKC,iBAAL;AAAgB;AACd,cAAM;AACJd,UAAAA,KADI;AAEJG,UAAAA,KAFI;AAGJI,UAAAA,WAHI;AAIJQ,UAAAA,IAAI,GAAG,EAJH;AAKJ/B,UAAAA,OAAO,GAAG,KALN;AAMJqB,UAAAA,SAAS,GAAG,KANR;AAOJI,UAAAA,QAAQ,GAAG,KAPP;AAQJE,UAAAA;AARI,YASFxB,MATJ;AAWA,YAAI6B,aAAa,GAAG,GAApB;AACA,YAAIP,QAAQ,KAAK,IAAb,IAAqBzB,OAAO,KAAK,KAArC,EAA4CgC,aAAa,GAAG,GAAhB,CAA5C,KACK,IAAIhC,OAAO,KAAK,IAAhB,EAAsBgC,aAAa,GAAGL,UAAU,IAAI,GAA9B;AAE3B,YAAIM,SAAJ;;AAEA,YAAI,CAACjB,KAAL,EAAY;AACViB,UAAAA,SAAS,GAAG/B,KAAK,CACdG,GADS,CACL,SADK,EACM,IADN,EAETA,GAFS,CAEL,OAFK,EAEI,IAFJ,EAGTA,GAHS,CAGL,OAHK,EAGIC,gBAAM,CAACa,KAAD,CAHV,EAITd,GAJS,CAIL,aAJK,EAIU,IAJV,EAKTA,GALS,CAKL,SALK,EAKML,OALN,EAMTK,GANS,CAML,WANK,EAMQgB,SANR,EAOThB,GAPS,CAOL,UAPK,EAOOoB,QAPP,EAQTpB,GARS,CAQL,YARK,EAQSsB,UAAU,IAAIK,aARvB,CAAZ;AASD,SAVD,MAUO;AACLC,UAAAA,SAAS,GAAG/B,KAAK,CACdG,GADS,CACL,SADK,EACMF,MAAM,CAAC+B,EADb,EAET7B,GAFS,CAEL,OAFK,EAEIC,gBAAM,CAACU,KAAD,CAFV,EAGTX,GAHS,CAGL,OAHK,EAGIC,gBAAM,CAACa,KAAD,CAHV,EAITd,GAJS,CAIL,SAJK,EAIML,OAJN,EAKTK,GALS,CAKL,WALK,EAKQgB,SALR,EAMThB,GANS,CAML,UANK,EAMOoB,QANP,EAOTpB,GAPS,CAOL,YAPK,EAOSsB,UAAU,IAAIK,aAPvB,CAAZ;AASA,cAAIT,WAAW,IAAIY,MAAM,CAACC,IAAP,CAAYb,WAAZ,EAAyBc,MAAzB,GAAkC,CAArD,EACEJ,SAAS,GAAGA,SAAS,CAClB5B,GADS,CACL,aADK,EACUC,gBAAM,CAACiB,WAAD,CADhB,EAETlB,GAFS,CAEL,OAFK,EAEIC,gBAAM,CAAC;AAAEgC,YAAAA,GAAG,EAAEtB,KAAK,CAACsB;AAAb,WAAD,CAFV,CAAZ;AAGH;;AAED,YAAI,CAACP,IAAL,EAAW;AACT,iBAAOE,SAAS,CAAC5B,GAAV,CAAc,aAAd,EAA6B,IAA7B,EAAmCA,GAAnC,CAAuC,aAAvC,EAAsD,IAAtD,CAAP;AACD,SAFD,MAEO;AACL;AACA,iBAAO4B,SAAS,CACb5B,GADI,CACA,aADA,EACeC,gBAAM,CAACyB,IAAD,CADrB,EAEJQ,QAFI,CAEK,CAAC,aAAD,EAAgB,OAAhB,CAFL,CAAP,CAFK;AAKN;AACF;;AACD,SAAKC,4BAAL;AAA2B;AACzB,eAAOtC,KAAK,CAACG,GAAN,CAAU,WAAV,EAAuBF,MAAM,CAACkB,SAA9B,CAAP;AACD;;AACD,SAAKoB,2BAAL;AAA0B;AACxB,YAAIf,WAAW,GAAG,KAAlB;;AACA,YAAIvB,MAAM,CAACuB,WAAX,EAAwB;AACtBA,UAAAA,WAAW,GAAG,EAAE,GAAGvB,MAAM,CAACuB;AAAZ,WAAd;AACD;;AACD,YAAIvB,MAAM,CAACuC,IAAX,EAAiB;AACf;AACA,gBAAMC,QAAQ,GAAGzC,KAAK,CAAC0C,KAAN,CAAY,CAAC,OAAD,EAAU,KAAV,EAAiB,KAAjB,CAAZ,CAAjB;;AACA,cAAID,QAAQ,IAAIxC,MAAM,CAACuC,IAAvB,EAA6B;AAC3B,mBAAOxC,KAAK,CACTG,GADI,CACA,aADA,EACeC,gBAAM,CAACH,MAAM,CAACuC,IAAR,CADrB,EAEJrC,GAFI,CAEA,UAFA,EAEYC,gBAAM,CAACH,MAAM,CAACmB,QAAR,CAFlB,EAGJjB,GAHI,CAIH,aAJG,EAKHC,gBAAM,CAAC,EACL,GAAGoB,WADE;AAELmB,cAAAA,KAAK,EAAE,EAAE,GAAGnB,WAAW,CAACmB,KAAjB;AAAwBC,gBAAAA,SAAS,EAAE;AAAnC;AAFF,aAAD,CALH,EAUJzC,GAVI,CAUA,WAVA,EAUa,OAAO0C,MAAP,KAAkB,WAV/B,CAAP;AAWD,WAZD,MAYO;AACL,mBAAO7C,KAAK,CAACG,GAAN,CAAU,UAAV,EAAsBC,gBAAM,CAACH,MAAM,CAACmB,QAAR,CAA5B,EAA+CjB,GAA/C,CACL,aADK,EAELC,gBAAM,CAAC,EACL,GAAGoB,WADE;AAELmB,cAAAA,KAAK,EAAE,EAAE,GAAGnB,WAAW,CAACmB,KAAjB;AAAwBC,gBAAAA,SAAS,EAAE;AAAnC;AAFF,aAAD,CAFD,CAAP;AAOD;AACF;;AACD,eAAO5C,KAAP;AACD;;AACD,SAAK8C,iBAAL;AAAgB;AACd,eAAO9C,KAAK,CAACG,GAAN,CAAU,UAAV,EAAsBF,MAAM,CAACuC,IAA7B,CAAP;AACD;;AACD,SAAKO,oBAAL;AAAmB;AACjB;AACA,YAAIC,wBAAwB,GAAG,IAA/B;AACA,YAAIC,UAAU,GAAG,EAAjB;;AACA,YAAIhD,MAAM,CAACiD,QAAP,IAAmBjD,MAAM,CAACiD,QAAP,CAAgBf,MAAhB,GAAyB,CAAhD,EAAmD;AACjDa,UAAAA,wBAAwB,GAAG/C,MAAM,CAACiD,QAAP,CAAgB,CAAhB,EAAmBC,QAA9C;AACAF,UAAAA,UAAU,GAAGhD,MAAM,CAACiD,QAAP,CAAgBE,GAAhB,CAAoBvB,IAAI,IAAI;AACvC,mBAAOA,IAAI,CAACG,EAAZ;AACD,WAFY,CAAb;AAGD;;AACD,YAAIqB,kBAAkB,GAAGrD,KAAK,CAACsD,GAAN,CAAU,aAAV,CAAzB;AACA,cAAMC,cAAc,GAAGC,aAAG,CAACC,KAAJ,CAAU,CAACD,aAAG,CAACP,UAAD,CAAJ,EAAkBI,kBAAlB,CAAV,CAAvB;AACA,eAAOrD,KAAK,CACTG,GADI,CACA,aADA,EACeoD,cADf,EAEJpD,GAFI,CAEA,qBAFA,EAEuBC,gBAAM,CAACH,MAAM,CAACiD,QAAR,CAF7B,EAGJ/C,GAHI,CAGA,2BAHA,EAG6B6C,wBAH7B,CAAP;AAID;;AACD,SAAKU,0BAAL;AAAyB;AACvB,eAAO1D,KAAK,CAACG,GAAN,CAAU,eAAV,EAA2BF,MAAM,CAACiC,IAAlC,CAAP;AACD;;AACD,SAAKyB,0BAAL;AAAyB;AACvB,eAAO3D,KAAK,CACTG,GADI,CACA,gBADA,EACkBF,MAAM,CAAC2D,OADzB,EAEJzD,GAFI,CAEA,eAFA,EAEiB,EAFjB;AAAA,SAGJA,GAHI,CAGA,eAHA,EAGiBC,gBAAM,CAACH,MAAM,CAAC4D,aAAR,CAHvB,EAIJ1D,GAJI,CAIA,iBAJA,EAImBF,MAAM,CAAC6D,QAJ1B,CAAP;AAKD;;AACD;AACE,aAAO9D,KAAP;AA9HJ;AAgID,CAjID;;AClCA,MAAM+D,cAAc,GAAG,WAAvB;AACO,MAAMC,WAAW,GAAI,GAAED,cAAe,aAAtC;AACA,MAAME,kBAAkB,GAAI,GAAEF,cAAe,oBAA7C;;;;;;;;ACCP,IAAItE,YAAY,GAAGC,aAAG,CAAC;AACrBwE,EAAAA,SAAS,EAAE,IADU;AAErBC,EAAAA,OAAO,EAAE,IAFY;AAGrBC,EAAAA,sBAAsB,EAAE;AAHH,CAAD,CAAtB;AAMA,sBAAe,CAACpE,KAAK,GAAGP,YAAT,EAAuBQ,MAAvB,KAAkC;AAC/C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAK+D,kBAAL;AAAyB;AACvB,eAAOjE,KAAK,CAACG,GAAN,CAAU,wBAAV,EAAoCF,MAAM,CAACoE,MAA3C,CAAP;AACD;;AACD,SAAKL,WAAL;AAAkB;AAChB,eAAOhE,KAAK,CACTG,GADI,CACA,WADA,EACaF,MAAM,CAACiE,SADpB,EAEJ/D,GAFI,CAEA,SAFA,EAEWF,MAAM,CAACkE,OAFlB,CAAP;AAGD;;AACD;AACE,aAAOnE,KAAP;AAVJ;AAYD,CAbD;;ACTA;AACA;AACA;AACA;AACA;;AACA;AACA,MAAMsE,gBAAgB,GAAGC,OAAO,IAAIC,KAAK,IAAIC,IAAI,IAAIxE,MAAM,IAAI;AAC7D,MAAIA,MAAM,CAACC,IAAP,KAAgB,qBAApB,EAA2C;AACzC,WAAOuE,IAAI,CAACxE,MAAD,CAAX;AACD;;AAED,QAAM;AACJyE,IAAAA,OAAO,EAAE;AAAEC,MAAAA,MAAF;AAAUC,MAAAA;AAAV;AADL,MAEF3E,MAFJ;AAGAsE,EAAAA,OAAO,CAACI,MAAD,CAAP,CAAgB,GAAGC,IAAnB;AACD,CATD;;ACNA;AAqBWC;AAOX,mBAAe,CAACC,eAAD,EAAkBrF,YAAlB,EAAgC8E,OAAhC,KAA4C;AACzD,MAAIQ,uBAAuB,GAAGC,CAAC,IAAIA,CAAnC;;AAEA,MAAI,OAAOnC,MAAP,IAAiB,WAArB,EAAkC;AAChCkC,IAAAA,uBAAuB,GAAGlC,MAAM,CAACoC,4BAAP,GACtBpC,MAAM,CAACoC,4BAAP,EADsB,GAEtBD,CAAC,IAAIA,CAFT;AAGD;;AAED,QAAME,cAAc,GAAGC,wCAAoB,EAA3C;AAEA,QAAMC,UAAQ,GAAG;AACfC,IAAAA,UAAU,EAAEC,iBADG;AAEfC,IAAAA,OAAO,EAAEC,cAFM;AAGfC,IAAAA,IAAI,EAAEC,oBAHS;AAIfC,IAAAA,OAAO,EAAEC,cAJM;AAKf,OAAGd;AALY,GAAjB;;AAQA,QAAMe,aAAa,GAAG,CAACC,gBAAgB,GAAG,EAApB,KAA2B;AAC/C,UAAMC,WAAW,GAAGC,8BAAe,CAAC,EAClC,GAAGF,gBAD+B;AAElC;AACA,SAAGV;AAH+B,KAAD,CAAnC;AAMA,WAAOW,WAAP;AACD,GARD;;AAUA,QAAMvB,KAAK,GAAG/E,YAAY,IAAI;AAC5B,UAAMwG,OAAO,GAAGf,cAAc,CAACgB,GAA/B;AAEA,UAAMC,UAKL,GAAGC,aAAO,CACTC,qBAAe,CACbC,mCADa,EAEbpB,cAFa,EAGbZ,gBAAgB,CAACC,OAAD,CAHH,CADN,EAMTgC,sCAAuB,CAAC;AACtBV,MAAAA,aADsB;AAEtBI,MAAAA;AAFsB,KAAD,CANd,EAUTlB,uBAVS,CALX;AAkBA,UAAMP,KAGL,GAAGgC,iBAAW,CAACX,aAAa,EAAd,EAAkBpG,YAAlB,EAAgC0G,UAAhC,CAHf;AAKA3B,IAAAA,KAAK,CAACyB,OAAN,GAAgBA,OAAhB;;AACAzB,IAAAA,KAAK,CAACiC,KAAN,GAAc,MAAMjC,KAAK,CAACkC,QAAN,CAAeC,wBAAf,CAApB;;AAEA,WAAOnC,KAAP;AACD,GA9BD;;AAgCAK,EAAAA,kBAAU,GAAGL,KAAK,CAAC/E,YAAD,CAAlB;AACA,SAAOoF,kBAAP;AACD,CA/DD;;MC5Ba+B,iBAAiB,GAAG5G,KAAK,IAAI;AACxC,SAAOA,KAAK,CAAC0C,KAAN,CAAY,CAAC,YAAD,EAAe,SAAf,CAAZ,CAAP;AACD;AAEM,MAAMmE,oBAAoB,GAAG7G,KAAK,IAAI;AAC3C,SAAOA,KAAK,CAAC0C,KAAN,CAAY,CAAC,YAAD,EAAe,MAAf,CAAZ,CAAP;AACD,CAFM;AAIA,MAAMoE,uBAAuB,GAAG9G,KAAK,IAAI;AAC9C,SAAOA,KAAK,CAAC0C,KAAN,CAAY,CAAC,YAAD,EAAe,aAAf,CAAZ,CAAP;AACD,CAFM;;;;;;;;;MCLMqE,gBAAgB,GAAGC,KAAK,IAAI;AACvC,MAAIC,KAAK,CAACC,OAAN,CAAcF,KAAd,CAAJ,EACE,OAAO,UAAUG,QAAV,GAAqB;AAC1B,UAAMC,WAAG,CAACJ,KAAD,CAAT;AACD,GAFD;AAGF,SAAOA,KAAP;AACD;MAEYK,aAAa,GAAG,CAAC;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAD,EAAmB/C,KAAK,GAAGgD,kBAA3B,KAA4C;AACvE,MACEC,OAAO,CAACC,GAAR,CAAYlD,KAAK,CAACsB,gBAAlB,EAAoCwB,GAApC,KACA9C,KAAK,CAACsB,gBAAN,CAAuBwB,GAAvB,MAAgCC,OAFlC,EAIE;AACF/C,EAAAA,KAAK,CAACsB,gBAAN,CAAuBwB,GAAvB,IAA8BC,OAA9B;AAEA/C,EAAAA,KAAK,CAACmD,cAAN,CAAqBnD,KAAK,CAACqB,aAAN,CAAoBrB,KAAK,CAACsB,gBAA1B,CAArB;AACD;MAEY8B,UAAU,GAAG,CAAC;AAAEN,EAAAA,GAAF;AAAOO,EAAAA;AAAP,CAAD,EAAgBrD,KAAK,GAAGgD,kBAAxB,KAAyC;AACjE,QAAML,QAAQ,GAAGJ,gBAAgB,CAACc,IAAD,CAAjC;AACA,MAAIC,OAAO,GAAGL,OAAO,CAACC,GAAR,CAAYlD,KAAK,CAACuD,aAAlB,EAAiCT,GAAjC,CAAd;;AAEA,MAAIU,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzC,UAAMC,aAAa,GAAG3D,KAAK,CAACuD,aAAN,CAAoBT,GAApB,CAAtB,CADyC;;AAGzC,QAAIQ,OAAO,IAAIK,aAAa,CAACN,IAAd,KAAuBV,QAAtC,EAAgD;AAC9CgB,MAAAA,aAAa,CAACC,IAAd,CAAmBC,MAAnB;AACAP,MAAAA,OAAO,GAAG,KAAV;AACD;AACF;;AACDQ,EAAAA,OAAO,CAACC,IAAR,CAAa,mBAAb,EAAkCjB,GAAlC,EAAuC,WAAvC,EAAoDQ,OAApD;;AAEA,MAAI,CAACA,OAAL,EAAc;AACZtD,IAAAA,KAAK,CAACuD,aAAN,CAAoBT,GAApB,IAA2B;AACzBA,MAAAA,GADyB;AAEzBO,MAAAA,IAAI,EAAEV,QAFmB;AAGzBiB,MAAAA,IAAI,EAAE5D,KAAK,CAACyB,OAAN,CAAckB,QAAd;AAHmB,KAA3B;AAKD;AACF;MAEYqB,WAAW,GAAG,CAAC;AAAElB,EAAAA,GAAF;AAAOC,EAAAA,OAAP;AAAgBM,EAAAA;AAAhB,CAAD,EAAyBrD,KAAK,GAAGgD,kBAAjC,KAAkD;AAC3Ec,EAAAA,OAAO,CAACC,IAAR,CAAa,oBAAb,EAAmCjB,GAAnC;AACA,MAAIC,OAAJ,EAAaF,aAAa,CAAC;AAAEC,IAAAA,GAAF;AAAOC,IAAAA;AAAP,GAAD,EAAmB/C,KAAnB,CAAb;AACb,MAAIqD,IAAJ,EAAUD,UAAU,CAAC;AAAEN,IAAAA,GAAF;AAAOO,IAAAA;AAAP,GAAD,EAAgBrD,KAAhB,CAAV;AACX;MAEYiE,cAAc,GAAGD;;MChDjBE,UAAU,GAAG,CAACxE,SAAD,EAAYC,OAAZ,KACxBlE,cAAM,CAAC+D,WAAD,EAAc;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,CAAd;MAEKwE,gBAAgB,GAAGtE,MAAM,IACpCpE,cAAM,CAACgE,kBAAD,EAAqB;AAAEI,EAAAA;AAAF,CAArB;;;;;;;;;;;;;;;;;;;;;;;;;"}