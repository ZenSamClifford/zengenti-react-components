{"version":3,"file":"reducers-29d0efa9.js","sources":["../src/app/core/util/fromJSOrdered.js","../src/app/features/login/redux/types.js","../src/app/features/login/redux/reducers.js"],"sourcesContent":["import { Seq } from 'immutable';\r\n\r\nconst fromJSOrdered = js => {\r\n  return typeof js !== 'object' || js === null\r\n    ? js\r\n    : Array.isArray(js)\r\n    ? Seq(js)\r\n        .map(fromJSOrdered)\r\n        .toList()\r\n    : Seq(js)\r\n        .map(fromJSOrdered)\r\n        .toOrderedMap();\r\n};\r\n\r\nexport default fromJSOrdered;\r\n","const ACTION_PREFIX = '@USER/';\r\nexport const VALIDATE_USER = `${ACTION_PREFIX}VALIDATE_USER`;\r\nexport const SET_AUTHENTICATION_STATE = `${ACTION_PREFIX}SET_AUTHENTICATION_STATE`;\r\nexport const LOGIN_USER = `${ACTION_PREFIX}LOGIN_USER`;\r\nexport const LOGIN_SUCCESSFUL = `${ACTION_PREFIX}LOGIN_SUCCESSFUL`;\r\nexport const LOGIN_FAILED = `${ACTION_PREFIX}LOGIN_FAILED`;\r\nexport const LOGOUT_USER = `${ACTION_PREFIX}LOGOUT_USER`;\r\nexport const REGISTER_USER = `${ACTION_PREFIX}REGISTER_USER`;\r\nexport const REGISTER_USER_SUCCESS = `${ACTION_PREFIX}REGISTER_USER_SUCCESS`;\r\nexport const REGISTER_USER_FAILED = `${ACTION_PREFIX}REGISTER_USER_FAILED`;\r\n\r\nexport const REQUEST_USER_PASSWORD_RESET = `${ACTION_PREFIX}REQUEST_USER_PASSWORD_RESET`;\r\nexport const RESET_USER_PASSWORD = `${ACTION_PREFIX}RESET_USER_PASSWORD`;\r\nexport const SET_REQUEST_USER_PASSWORD_RESET_SENDING = `${ACTION_PREFIX}SET_REQUEST_USER_PASSWORD_RESET_SENDING`;\r\nexport const SET_REQUEST_USER_PASSWORD_RESET_SUCCESS = `${ACTION_PREFIX}SET_REQUEST_USER_PASSWORD_RESET_SUCCESS`;\r\nexport const SET_REQUEST_USER_PASSWORD_RESET_ERROR = `${ACTION_PREFIX}SET_REQUEST_USER_PASSWORD_RESET_ERROR`;\r\nexport const SET_RESET_USER_PASSWORD_SENDING = `${ACTION_PREFIX}SET_RESET_USER_PASSWORD_SENDING`;\r\nexport const SET_RESET_USER_PASSWORD_SUCCESS = `${ACTION_PREFIX}SET_RESET_USER_PASSWORD_SUCCESS`;\r\nexport const SET_RESET_USER_PASSWORD_ERROR = `${ACTION_PREFIX}SET_RESET_USER_PASSWORD_ERROR`;\r\n","import { List, Map } from 'immutable';\r\nimport fromJSOrdered from '~/core/util/fromJSOrdered';\r\nimport {\r\n  REGISTER_USER,\r\n  REGISTER_USER_FAILED,\r\n  REGISTER_USER_SUCCESS,\r\n  SET_AUTHENTICATION_STATE,\r\n  LOGIN_USER,\r\n  LOGOUT_USER,\r\n  SET_REQUEST_USER_PASSWORD_RESET_SENDING,\r\n  SET_REQUEST_USER_PASSWORD_RESET_SUCCESS,\r\n  SET_REQUEST_USER_PASSWORD_RESET_ERROR,\r\n  SET_RESET_USER_PASSWORD_SENDING,\r\n  SET_RESET_USER_PASSWORD_SUCCESS,\r\n  SET_RESET_USER_PASSWORD_ERROR,\r\n} from './types';\r\n\r\nconst defaultAuthenticationState = Map({\r\n  authenticated: false,\r\n  authenticationError: false,\r\n  clientCredentials: null,\r\n  error: false,\r\n  loading: false,\r\n});\r\n\r\nconst defaultPasswordResetRequestValues = {\r\n  isSending: false,\r\n  sent: false,\r\n  error: null,\r\n};\r\n\r\nconst defaultResetPasswordValues = {\r\n  isSending: false,\r\n  sent: false,\r\n  error: null,\r\n};\r\n\r\nexport const initialUserState = Map({\r\n  authenticationState: defaultAuthenticationState,\r\n  passwordResetRequest: defaultPasswordResetRequestValues,\r\n  resetPassword: defaultResetPasswordValues,\r\n  groups: new List([]),\r\n});\r\n\r\nexport default (state = initialUserState, action) => {\r\n  switch (action.type) {\r\n    case LOGIN_USER:\r\n    case LOGOUT_USER:\r\n    case SET_AUTHENTICATION_STATE: {\r\n      if (!action.authenticationState) {\r\n        action.authenticationState = defaultAuthenticationState.toJS();\r\n      }\r\n\r\n      const loading = action.type === LOGIN_USER;\r\n\r\n      const {\r\n        authenticationState: {\r\n          error = false,\r\n          authenticated,\r\n          authenticationError = false,\r\n          clientCredentials = null,\r\n        },\r\n        user,\r\n      } = action;\r\n\r\n      if (user) {\r\n        user.name = `${user.firstName} ${user.lastName}`;\r\n        user.isZengentiStaff = user.email.includes('@zengenti.com');\r\n      }\r\n\r\n      const nextState = {\r\n        ...initialUserState.toJS(),\r\n        ...(user || state.toJS()),\r\n        authenticationState: {\r\n          authenticated:\r\n            authenticated ||\r\n            state.getIn(['authenticationState', 'authenticated']),\r\n          authenticationError,\r\n          clientCredentials,\r\n          error,\r\n          loading,\r\n        },\r\n      };\r\n      return fromJSOrdered(nextState);\r\n    }\r\n    // REGISTER_USER is the trigger to set the user.registration initial state\r\n    // and will set user.registration.loading to true\r\n    // REGISTER_USER_FAILED will unset user.registration.loading and will set\r\n    // the value in user.registration.error\r\n    // REGISTER_USER_SUCCESS will unset user.registration.loading and will\r\n    // set user.registration to the created user from the api response\r\n    case REGISTER_USER:\r\n    case REGISTER_USER_FAILED:\r\n    case REGISTER_USER_SUCCESS: {\r\n      const { error, user } = action;\r\n\r\n      // Set registration object from the supplied action.user\r\n      // so we can call these values back later\r\n      const nextState = state.set(\r\n        'registration',\r\n        user ? fromJSOrdered(user) : state.get('registration', Map())\r\n      );\r\n\r\n      // Set registration flags so the UI can track the status\r\n      return nextState\r\n        .setIn(\r\n          ['registration', 'success'],\r\n          action.type === REGISTER_USER_SUCCESS\r\n        )\r\n        .setIn(['registration', 'error'], error || false)\r\n        .setIn(['registration', 'loading'], action.type === REGISTER_USER);\r\n    }\r\n    case SET_REQUEST_USER_PASSWORD_RESET_SENDING:\r\n      return state.setIn(['passwordResetRequest', 'isSending'], true);\r\n    case SET_REQUEST_USER_PASSWORD_RESET_SUCCESS:\r\n      return state\r\n        .setIn(['passwordResetRequest', 'isSending'], false)\r\n        .setIn(['passwordResetRequest', 'sent'], true);\r\n    case SET_REQUEST_USER_PASSWORD_RESET_ERROR:\r\n      return state\r\n        .setIn(['passwordResetRequest', 'isSending'], false)\r\n        .setIn(['passwordResetRequest', 'error'], action.error);\r\n    case SET_RESET_USER_PASSWORD_SENDING:\r\n      return state.setIn(['resetPassword', 'isSending'], true);\r\n    case SET_RESET_USER_PASSWORD_SUCCESS:\r\n      return state\r\n        .setIn(['resetPassword', 'isSending'], false)\r\n        .setIn(['resetPassword', 'sent'], true);\r\n    case SET_RESET_USER_PASSWORD_ERROR:\r\n      return state\r\n        .setIn(['resetPassword', 'isSending'], false)\r\n        .setIn(['resetPassword', 'error'], action.error);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n"],"names":["fromJSOrdered","js","Array","isArray","Seq","map","toList","toOrderedMap","ACTION_PREFIX","VALIDATE_USER","SET_AUTHENTICATION_STATE","LOGIN_USER","LOGIN_SUCCESSFUL","LOGIN_FAILED","LOGOUT_USER","REGISTER_USER","REGISTER_USER_SUCCESS","REGISTER_USER_FAILED","REQUEST_USER_PASSWORD_RESET","RESET_USER_PASSWORD","SET_REQUEST_USER_PASSWORD_RESET_SENDING","SET_REQUEST_USER_PASSWORD_RESET_SUCCESS","SET_REQUEST_USER_PASSWORD_RESET_ERROR","SET_RESET_USER_PASSWORD_SENDING","SET_RESET_USER_PASSWORD_SUCCESS","SET_RESET_USER_PASSWORD_ERROR","defaultAuthenticationState","Map","authenticated","authenticationError","clientCredentials","error","loading","defaultPasswordResetRequestValues","isSending","sent","defaultResetPasswordValues","initialUserState","authenticationState","passwordResetRequest","resetPassword","groups","List","state","action","type","toJS","user","name","firstName","lastName","isZengentiStaff","email","includes","nextState","getIn","set","get","setIn"],"mappings":"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"}