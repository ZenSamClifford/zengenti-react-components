{"version":3,"file":"sagas-d669611c.js","sources":["../src/app/core/util/fromJSOrdered.js","../src/app/features/login/redux/types.js","../src/app/features/login/redux/reducers.js","../src/app/features/login/redux/selectors.js","../src/app/core/util/ContensisManagementApi.js","../src/app/features/login/util/CookieHelper.class.js","../src/app/features/login/transformations/mapClientCredentials.js","../src/app/features/login/util/LoginHelper.class.js","../src/app/features/login/redux/sagas.js"],"sourcesContent":["import { Seq } from 'immutable';\r\n\r\nconst fromJSOrdered = js => {\r\n  return typeof js !== 'object' || js === null\r\n    ? js\r\n    : Array.isArray(js)\r\n    ? Seq(js)\r\n        .map(fromJSOrdered)\r\n        .toList()\r\n    : Seq(js)\r\n        .map(fromJSOrdered)\r\n        .toOrderedMap();\r\n};\r\n\r\nexport default fromJSOrdered;\r\n","const ACTION_PREFIX = '@USER/';\r\nexport const SET_USER_LOADING = `${ACTION_PREFIX}SET_USER_LOADING`;\r\nexport const SET_AUTHENTICATION_STATE = `${ACTION_PREFIX}SET_AUTHENTICATION_STATE`;\r\n// export const UPDATE_USER = `${ACTION_PREFIX}UPDATE_USER`;\r\nexport const LOGIN_USER = `${ACTION_PREFIX}LOGIN_USER`;\r\nexport const LOGIN_SUCCESSFUL = `${ACTION_PREFIX}LOGIN_SUCCESSFUL`;\r\nexport const LOGIN_FAILED = `${ACTION_PREFIX}LOGIN_FAILED`;\r\nexport const LOGOUT_USER = `${ACTION_PREFIX}LOGOUT_USER`;\r\n// export const TOGGLE_LOGIN_MODE = `${ACTION_PREFIX}TOGGLE_LOGIN_MODE`;\r\nexport const CREATE_USER_ACCOUNT = `${ACTION_PREFIX}CREATE_USER_ACCOUNT`;\r\n// export const VALIDATE_USER = `${ACTION_PREFIX}VALIDATE_USER`;\r\n// export const SET_PRE_LOGIN_PATH = `${ACTION_PREFIX}SET_PRE_LOGIN_PATH`;\r\n// export const SET_USER_ENVIRONMENTS = `${ACTION_PREFIX}SET_USER_ENVIRONMENTS`;\r\n","import { List, Map } from 'immutable';\r\nimport fromJSOrdered from '~/core/util/fromJSOrdered';\r\nimport { SET_USER_LOADING, SET_AUTHENTICATION_STATE } from './types';\r\n\r\nconst defaultAuthenticationState = Map({\r\n  authenticated: false,\r\n  authenticationError: false,\r\n  clientCredentials: null,\r\n  error: false,\r\n  loading: false,\r\n});\r\n\r\nexport const initialUserState = Map({\r\n  authenticationState: defaultAuthenticationState,\r\n  groups: new List([]),\r\n});\r\n\r\nexport default (state = initialUserState, action) => {\r\n  switch (action.type) {\r\n    case SET_USER_LOADING:\r\n    case SET_AUTHENTICATION_STATE: {\r\n      if (!action.authenticationState) {\r\n        action.authenticationState = defaultAuthenticationState.toJS();\r\n      }\r\n\r\n      const loading = action.type === SET_USER_LOADING;\r\n\r\n      const {\r\n        authenticationState: {\r\n          error = false,\r\n          authenticated,\r\n          authenticationError = false,\r\n          clientCredentials = null,\r\n        },\r\n        user,\r\n      } = action;\r\n\r\n      if (user) {\r\n        user.name = `${user.firstName} ${user.lastName}`;\r\n        user.isZengentiStaff = user.email.includes('@zengenti.com');\r\n      }\r\n\r\n      const nextState = {\r\n        ...initialUserState.toJS(),\r\n        ...user,\r\n        authenticationState: {\r\n          authenticated:\r\n            authenticated ||\r\n            state.getIn(['authenticationState', 'authenticated']),\r\n          authenticationError,\r\n          clientCredentials,\r\n          error,\r\n          loading,\r\n        },\r\n      };\r\n      return fromJSOrdered(nextState);\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const selectUserIsLoading = state => {\r\n  return state.getIn(['user', 'authenticationState', 'loading']);\r\n};\r\nexport const selectUserIsAuthenticated = state => {\r\n  return (\r\n    state.getIn(['user', 'authenticationState', 'authenticated']) &&\r\n    state.getIn(['user']) != null\r\n  );\r\n};\r\nexport const selectUserAuthenticationError = state => {\r\n  return state.getIn(['user', 'authenticationState', 'authenticationError']);\r\n};\r\nexport const selectUserError = state => {\r\n  return state.getIn(['user', 'authenticationState', 'error']);\r\n};\r\nexport const selectClientCredentials = state => {\r\n  return state.getIn(['user', 'authenticationState', 'clientCredentials']);\r\n};\r\nexport const selectUser = state => {\r\n  return state.getIn(['user']);\r\n};\r\nexport const selectUserIsZengentiStaff = state => {\r\n  return state.getIn(['user', 'isZengentiStaff']);\r\n};\r\nexport const selectUserGuid = state => {\r\n  return state.getIn(['user', 'id']);\r\n};\r\nexport const selectUsername = state => {\r\n  return state.getIn(['user', 'userName']);\r\n};\r\nexport const selectUserEmail = state => {\r\n  return state.getIn(['user', 'email']);\r\n};\r\nexport const selectUserGroups = state => {\r\n  return state.getIn(['user', 'groups']);\r\n};\r\nexport const selectUserSecurityToken = state => {\r\n  return state.getIn([\r\n    'user',\r\n    'authenticationState',\r\n    'clientCredentials',\r\n    'contensisClassicToken',\r\n  ]);\r\n};\r\nexport const selectUserMobile = state => {\r\n  return state.getIn(['user', 'custom', 'mobile']);\r\n};\r\nexport const selectUserLandline = state => {\r\n  return state.getIn(['user', 'custom', 'telephone']);\r\n};\r\nexport const selectUserCanCallMobileInEmergency = state => {\r\n  return state.getIn(['user', 'custom', 'canCallMobileInEmergency']);\r\n};\r\n","import { Client } from 'contensis-management-api';\r\n\r\nexport const getManagementAPIClient = ({\r\n  bearerToken,\r\n  bearerTokenExpiryDate,\r\n  refreshToken,\r\n  refreshTokenExpiryDate,\r\n  contensisClassicToken,\r\n}) => {\r\n  const CMS_URL = SERVERS.api; /* global SERVERS */\r\n  const projectId = PROJECTS[0].id; /* global PROJECTS */\r\n\r\n  const managementApiClient = Client.create({\r\n    clientType: 'contensis_classic_refresh_token',\r\n    clientDetails: {\r\n      refreshToken,\r\n    },\r\n    projectId: projectId,\r\n    rootUrl: CMS_URL,\r\n  });\r\n\r\n  if (bearerToken) managementApiClient.bearerToken = bearerToken;\r\n  if (bearerTokenExpiryDate)\r\n    managementApiClient.bearerTokenExpiryDate = bearerTokenExpiryDate;\r\n  if (refreshToken) managementApiClient.refreshToken = refreshToken;\r\n  if (refreshTokenExpiryDate)\r\n    managementApiClient.refreshTokenExpiryDate = refreshTokenExpiryDate;\r\n  if (contensisClassicToken)\r\n    managementApiClient.contensisClassicToken = contensisClassicToken;\r\n\r\n  return managementApiClient;\r\n};\r\n","import Cookies from 'js-cookie';\r\n\r\nconst COOKIE_VALID_DAYS = 1; // 0 = Session cookie\r\n\r\n// Override the default js-cookie conversion / encoding\r\n// methods so the written values work with Contensis sites\r\nconst _cookie = Cookies.withConverter({\r\n  read: value => decodeURIComponent(value),\r\n  write: value => encodeURIComponent(value),\r\n});\r\n\r\nexport class CookieHelper {\r\n  static GetCookie(name) {\r\n    let cookie = _cookie.get(name);\r\n    if (typeof cookie == 'undefined') {\r\n      return null;\r\n    }\r\n    return cookie;\r\n  }\r\n\r\n  static SetCookie(name, value, maxAgeDays = COOKIE_VALID_DAYS) {\r\n    maxAgeDays === 0\r\n      ? _cookie.set(name, value)\r\n      : _cookie.set(name, value, { expires: maxAgeDays });\r\n  }\r\n\r\n  static DeleteCookie(name) {\r\n    _cookie.remove(name);\r\n  }\r\n}\r\n","import { mapJson } from '~/core/util/json-mapper';\r\n\r\nconst clientCredentials = {\r\n  bearerToken: 'bearerToken',\r\n  bearerTokenExpiryDate: 'bearerTokenExpiryDate',\r\n  refreshToken: 'refreshToken',\r\n  refreshTokenExpiryDate: 'refreshTokenExpiryDate',\r\n  contensisClassicToken: 'contensisClassicToken',\r\n};\r\nexport default obj => mapJson(obj, clientCredentials);\r\n","/* eslint-disable require-atomic-updates */\r\nimport { Client } from 'contensis-management-api';\r\nimport { getManagementAPIClient } from '~/core/util/ContensisManagementApi';\r\nimport { to } from 'await-to-js';\r\n\r\nimport { CookieHelper } from './CookieHelper.class';\r\n\r\nimport { initialUserState } from '../redux/reducers';\r\nimport mapClientCredentials from '../transformations/mapClientCredentials';\r\n\r\nexport const LOGIN_COOKIE = 'ContensisCMSUserName';\r\nexport const REFRESH_TOKEN_COOKIE = 'RefreshToken';\r\n\r\nexport class LoginHelper {\r\n  static CMS_URL = SERVERS.api || SERVERS.cms /* global SERVERS */;\r\n  static LOGIN_ROUTE = '/account/login';\r\n\r\n  static SetLoginCookies(apiClientCredentials) {\r\n    if (apiClientCredentials) {\r\n      CookieHelper.SetCookie(\r\n        LOGIN_COOKIE,\r\n        apiClientCredentials.contensisClassicToken\r\n      );\r\n      CookieHelper.SetCookie(\r\n        REFRESH_TOKEN_COOKIE,\r\n        apiClientCredentials.refreshToken\r\n      );\r\n    }\r\n  }\r\n\r\n  static GetCachedCredentials() {\r\n    return {\r\n      bearerToken: null,\r\n      bearerTokenExpiryDate: null,\r\n      refreshToken: CookieHelper.GetCookie(REFRESH_TOKEN_COOKIE),\r\n      refreshTokenExpiryDate: null,\r\n      contensisClassicToken: CookieHelper.GetCookie(LOGIN_COOKIE),\r\n    };\r\n  }\r\n\r\n  static ClearCachedCredentials() {\r\n    CookieHelper.DeleteCookie(LOGIN_COOKIE);\r\n    CookieHelper.DeleteCookie(REFRESH_TOKEN_COOKIE);\r\n  }\r\n\r\n  static GetClientForAuthentication = (username, password) => {\r\n    const projectId = PROJECTS[0].id; /* global PROJECTS */\r\n    return Client.create({\r\n      clientType: 'contensis_classic',\r\n      clientDetails: {\r\n        username,\r\n        password,\r\n      },\r\n      projectId: projectId,\r\n      rootUrl: LoginHelper.CMS_URL,\r\n    });\r\n  };\r\n\r\n  static async LoginUser(username, password) {\r\n    if (username && password) {\r\n      // Call LogonUser API\r\n      //const loginResponse = await SecurityApi.LogonUser(username, password);\r\n      const transientClient = LoginHelper.GetClientForAuthentication(\r\n        username,\r\n        password\r\n      );\r\n\r\n      // any error at this point should be treated like a login error\r\n      let clientErr, clientBearerToken;\r\n      [clientErr, clientBearerToken] = await to(\r\n        transientClient.ensureBearerToken()\r\n      );\r\n\r\n      if (clientErr) {\r\n        const authenticationError = clientErr.name.includes(\r\n          'ContensisAuthenticationError'\r\n        );\r\n        return {\r\n          authenticated: false,\r\n          authenticationError: authenticationError,\r\n          error: !authenticationError,\r\n          clientCredentials: null,\r\n        };\r\n      }\r\n\r\n      if (clientBearerToken) {\r\n        const clientCredentials = mapClientCredentials(transientClient);\r\n        this.SetLoginCookies(clientCredentials);\r\n        return {\r\n          authenticated: true,\r\n          authenticationError: false,\r\n          error: false,\r\n          clientCredentials,\r\n        };\r\n      }\r\n    } else {\r\n      // Don't call API if username and/or password empty\r\n      return {\r\n        authenticated: false,\r\n        authenticationError: false,\r\n        error: false,\r\n        clientCredentials: null,\r\n      };\r\n    }\r\n  }\r\n\r\n  static GetUserDetails = async clientCredentials => {\r\n    const client = getManagementAPIClient(clientCredentials);\r\n    const [error, user] = await to(client.security.users.getCurrent());\r\n    return {\r\n      error,\r\n      user,\r\n      clientCredentials: mapClientCredentials(client),\r\n    };\r\n  };\r\n\r\n  static LogoutUser() {\r\n    this.ClearCachedCredentials();\r\n    return initialUserState.toJS();\r\n  }\r\n\r\n  static ClientRedirectToHome(location) {\r\n    if (typeof window != 'undefined') {\r\n      let url = '/';\r\n      if (location) {\r\n        const { search, hash } = location.toJS();\r\n        url = search ? `${url}${search}` : url;\r\n        url = hash ? `${url}${hash}` : url;\r\n      }\r\n      window.location.href = url;\r\n    }\r\n  }\r\n\r\n  static ClientRedirectToSignInPage(redirectPath) {\r\n    let url = '/account/login';\r\n    if (typeof redirectPath === 'string')\r\n      url = `${url}?redirect_uri=${redirectPath}`;\r\n    window.location.href = url;\r\n  }\r\n\r\n  static ClientRedirectToPath(redirectPath) {\r\n    if (typeof redirectPath === 'string') window.location.href = redirectPath;\r\n    else LoginHelper.ClientRedirectToHome();\r\n  }\r\n\r\n  static isZengentiStaff(email) {\r\n    const emailRefs = ['@zengenti', '@contensis'];\r\n\r\n    return emailRefs.some(emailRef => {\r\n      if (email.includes(emailRef)) {\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { takeEvery, select, put, call } from 'redux-saga/effects';\r\nimport {\r\n  SET_USER_LOADING,\r\n  SET_AUTHENTICATION_STATE,\r\n  LOGIN_USER,\r\n  LOGOUT_USER,\r\n  // SET_USER_ENVIRONMENTS,\r\n} from './types';\r\nimport {\r\n  selectUserIsAuthenticated,\r\n  selectClientCredentials,\r\n} from './selectors';\r\n\r\nimport { LoginHelper } from '../util/LoginHelper.class';\r\nimport { setRoute as navigate } from '~/core/redux/actions/routing';\r\nimport { getManagementAPIClient } from '~/core/util/ContensisManagementApi';\r\nimport { queryParams } from '~/core/util/navigation';\r\nimport { selectCurrentSearch } from '~/core/redux/selectors/routing';\r\nimport mapClientCredentials from '../transformations/mapClientCredentials';\r\n\r\nexport const userSagas = [\r\n  takeEvery(LOGIN_USER, loginUserSaga),\r\n  takeEvery(LOGOUT_USER, logoutUserSaga),\r\n  takeEvery(SET_AUTHENTICATION_STATE, redirectAfterSuccessfulLoginSaga),\r\n  // takeEvery(LOGIN_SUCCESSFUL, getUserEnvironmentsSaga),\r\n];\r\n\r\nexport function* handleRequiresLoginSaga(action) {\r\n  const { staticRoute, routes, entry } = action;\r\n  // debugger;\r\n\r\n  // always validate and login user if cookies available on any route change\r\n  yield call(validateUserSaga);\r\n\r\n  // is route listed as needing a login?\r\n  const routeRequiresLogin =\r\n    (staticRoute && staticRoute.route.authRequired) ||\r\n    (routes &&\r\n      entry &&\r\n      (\r\n        routes.ContentTypeMappings.find(\r\n          item => item.contentTypeID == entry.sys.contentTypeId\r\n        ) || {}\r\n      ).authRequired);\r\n\r\n  if (routeRequiresLogin) {\r\n    const userLoggedIn = yield select(selectUserIsAuthenticated);\r\n    if (!userLoggedIn) {\r\n      LoginHelper.ClientRedirectToSignInPage(action.location.pathname);\r\n      // yield put(\r\n      //   navigate(`${LOGIN_ROUTE}?redirect_uri=${action.location.pathname}`)\r\n      // );\r\n    }\r\n  }\r\n}\r\n\r\nfunction* redirectAfterSuccessfulLoginSaga() {\r\n  const isLoggedIn = yield select(selectUserIsAuthenticated);\r\n  const redirectPath = queryParams(yield select(selectCurrentSearch))\r\n    .redirect_uri;\r\n\r\n  if (isLoggedIn && redirectPath) {\r\n    yield put(navigate(redirectPath));\r\n  }\r\n}\r\n\r\nfunction* loginUserSaga(action = {}) {\r\n  const { username, password } = action;\r\n  if (username) {\r\n    yield put({\r\n      type: SET_USER_LOADING,\r\n    });\r\n  }\r\n\r\n  // The elements we will eventually load into authenticationState\r\n  let clientCredentials = LoginHelper.GetCachedCredentials(),\r\n    error = false,\r\n    authenticated = false,\r\n    authenticationError = false,\r\n    user = null,\r\n    userError = false;\r\n\r\n  try {\r\n    if (!username) {\r\n      authenticated = true;\r\n    } else {\r\n      // here we are getting credentials from input username and password\r\n      // and destructuring the return object to our authenticationState elements\r\n      ({\r\n        error,\r\n        authenticated,\r\n        authenticationError,\r\n        clientCredentials,\r\n      } = yield LoginHelper.LoginUser(username, password));\r\n    }\r\n\r\n    // If the authenticated variable is true, we should have some clientCredentials\r\n    // continue getting the user's details with those credentials\r\n    if (authenticated) {\r\n      ({\r\n        error: userError,\r\n        user,\r\n        clientCredentials,\r\n      } = yield LoginHelper.GetUserDetails(clientCredentials));\r\n      if (userError) {\r\n        error = userError;\r\n        authenticated = false;\r\n        clientCredentials = null;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    error = e;\r\n    authenticated = false;\r\n    clientCredentials = null;\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(e);\r\n  } finally {\r\n    yield put({\r\n      type: SET_AUTHENTICATION_STATE,\r\n      authenticationState: {\r\n        clientCredentials,\r\n        authenticated,\r\n        authenticationError,\r\n        error,\r\n      },\r\n      user,\r\n    });\r\n    if (!authenticated || error) {\r\n      // Clear cookies if auth has failed in any way\r\n      yield LoginHelper.ClearCachedCredentials();\r\n    }\r\n  }\r\n}\r\nfunction* logoutUserSaga({ redirectPath }) {\r\n  yield LoginHelper.LogoutUser();\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    user: null,\r\n  });\r\n  // yield put({\r\n  //   type: SET_USER_ENVIRONMENTS,\r\n  // });\r\n  if (redirectPath) LoginHelper.ClientRedirectToPath(redirectPath);\r\n  else LoginHelper.ClientRedirectToSignInPage();\r\n}\r\n\r\n// function* getUserEnvironmentsSaga() {\r\n//   yield delay(6000);\r\n//   const securityToken = yield select(selectUserSecurityToken);\r\n//   const environments = yield SecurityApi.GetUsersEnvironments(securityToken);\r\n//   if (!environments.error) {\r\n//     environments.map((env, idx) => {\r\n//       if (env.alias.indexOf('-dr') > -1) {\r\n//         return [...environments.splice(idx, 1)];\r\n//       }\r\n//       return [...environments];\r\n//     });\r\n//     yield put({\r\n//       type: SET_USER_ENVIRONMENTS,\r\n//       environments,\r\n//     });\r\n//   }\r\n// }\r\n\r\nfunction* validateUserSaga() {\r\n  const userLoggedIn = yield select(selectUserIsAuthenticated);\r\n  if (userLoggedIn) return;\r\n\r\n  const credentials = LoginHelper.GetCachedCredentials();\r\n  if (credentials && !userLoggedIn && credentials.refreshToken) {\r\n    yield call(loginUserSaga);\r\n  }\r\n}\r\n\r\nexport function* refreshSecurityToken() {\r\n  const clientCredentials = yield select(selectClientCredentials).toJS();\r\n  const client = getManagementAPIClient(clientCredentials);\r\n  yield client.authenticate();\r\n\r\n  const loginResultObject = {};\r\n\r\n  const newClientCredentials = mapClientCredentials(client);\r\n\r\n  loginResultObject.clientCredentials = newClientCredentials;\r\n\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    loginResultObject,\r\n  });\r\n}\r\n"],"names":["fromJSOrdered","js","Array","isArray","Seq","map","toList","toOrderedMap","ACTION_PREFIX","SET_USER_LOADING","SET_AUTHENTICATION_STATE","LOGIN_USER","LOGIN_SUCCESSFUL","LOGIN_FAILED","LOGOUT_USER","CREATE_USER_ACCOUNT","defaultAuthenticationState","Map","authenticated","authenticationError","clientCredentials","error","loading","initialUserState","authenticationState","groups","List","state","action","type","toJS","user","name","firstName","lastName","isZengentiStaff","email","includes","nextState","getIn","selectUserIsLoading","selectUserIsAuthenticated","selectUserAuthenticationError","selectUserError","selectClientCredentials","selectUser","selectUserIsZengentiStaff","selectUserGuid","selectUsername","selectUserEmail","selectUserGroups","selectUserSecurityToken","selectUserMobile","selectUserLandline","selectUserCanCallMobileInEmergency","getManagementAPIClient","bearerToken","bearerTokenExpiryDate","refreshToken","refreshTokenExpiryDate","contensisClassicToken","CMS_URL","SERVERS","api","projectId","PROJECTS","id","managementApiClient","Client","create","clientType","clientDetails","rootUrl","COOKIE_VALID_DAYS","_cookie","Cookies","withConverter","read","value","decodeURIComponent","write","encodeURIComponent","CookieHelper","GetCookie","cookie","get","SetCookie","maxAgeDays","set","expires","DeleteCookie","remove","obj","mapJson","LOGIN_COOKIE","REFRESH_TOKEN_COOKIE","LoginHelper","SetLoginCookies","apiClientCredentials","GetCachedCredentials","ClearCachedCredentials","LoginUser","username","password","transientClient","GetClientForAuthentication","clientErr","clientBearerToken","to","ensureBearerToken","mapClientCredentials","LogoutUser","ClientRedirectToHome","location","window","url","search","hash","href","ClientRedirectToSignInPage","redirectPath","ClientRedirectToPath","emailRefs","some","emailRef","cms","LOGIN_ROUTE","GetUserDetails","client","security","users","getCurrent","userSagas","takeEvery","loginUserSaga","logoutUserSaga","redirectAfterSuccessfulLoginSaga","handleRequiresLoginSaga","staticRoute","routes","entry","call","validateUserSaga","routeRequiresLogin","route","authRequired","ContentTypeMappings","find","item","contentTypeID","sys","contentTypeId","userLoggedIn","select","pathname","isLoggedIn","queryParams","selectCurrentSearch","redirect_uri","put","navigate","userError","e","console","log","credentials","refreshSecurityToken","authenticate","loginResultObject","newClientCredentials"],"mappings":"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"}